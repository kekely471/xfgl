<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="${ctx.contextPath}/layui/commons/main.js" type="text/javascript"></script>
    <script src="${ctx.contextPath}/layui/commons/ztree/js/opentree.js" type="text/javascript"></script>
    <script src="${ctx.contextPath}/layui/commons/kindeditor/kindeditor.js" type="text/javascript"></script>
    <script src="${ctx.contextPath}/layui/commons/kindeditor/lang/zh_CN.js" type="text/javascript"></script>
    <link href="${ctx.contextPath}/layui/commons/css/formSelects.css" rel="stylesheet"/>
    <title>Title</title>
</head>
<style>
    .layui-form-label {
        width: 90px;
    }

    .layui-input-block {
        margin-left: 120px;
    }

</style>
<body style="background: #f2f2f2;">
<div class="contentBox">
    <div class="formBox" style="padding: 10px 150px 10px 30px;">
        <form class="layui-form" action="">
            <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                <legend>表单集合演示</legend>
            </fieldset>

            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label">表单项选择</label>
                <div class="layui-input-block">
                    <div id="formListSelect" class="xm-select-demo"></div>
                </div>
            </div>

            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label"><span class="redLabel">*</span>验证必填项</label>
                <div class="layui-input-block">
                    <input type="text" name="username" lay-verify="required" placeholder="请输入" value=""
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">验证手机</label>
                <div class="layui-input-block">
                    <input type="text" name="phone" lay-verify="phone" placeholder="请输入" value="" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">验证邮箱</label>
                <div class="layui-input-block">
                    <input type="text" name="email" lay-verify="email" placeholder="请输入" value="" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-td-3">
                <label class="layui-form-label">多规则验证</label>
                <div class="layui-input-block">
                    <input type="text" name="" lay-verify="required|number" placeholder="请输入" value=""
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-td-3">
                <label class="layui-form-label">验证日期</label>
                <div class="layui-input-block">
                    <input type="text" id="date" name="date" lay-verify="date" readonly placeholder="请选择日期" value=""
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-td-3">
                <label class="layui-form-label">验证身份证</label>
                <div class="layui-input-block">
                    <input type="text" name="" lay-verify="identity" placeholder="请输入" value="" autocomplete="off"
                           class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label">自定义验证</label>
                <div class="layui-input-inline">
                    <input type="text" name="" lay-verify="pass" placeholder="请输入" value="" autocomplete="off"
                           class="layui-input">
                </div>
                <div class="layui-form-mid layui-word-aux">请填写6到12位密码</div>
            </div>
            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label">单行选择框</label>
                <div class="layui-input-block">
                    <select name="interest" lay-filter="aihao">
                        <option value=""></option>
                        <option value="0">写作</option>
                        <option value="1" selected="">阅读</option>
                        <option value="2">游戏</option>
                        <option value="3">音乐</option>
                        <option value="4">旅行</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">人员弹出树</label>
                <div class="layui-input-block" id="bmry">

                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">部门弹出树</label>
                <div class="layui-input-block" id="bm">

                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">分组选择框</label>
                <div class="layui-input-block">
                    <select name="quiz">
                        <option value="">请选择问题</option>
                        <optgroup label="城市记忆">
                            <option value="你工作的第一个城市">你工作的第一个城市</option>
                        </optgroup>
                        <optgroup label="学生时代">
                            <option value="你的工号">你的工号</option>
                            <option value="你最喜欢的老师">你最喜欢的老师</option>
                        </optgroup>
                    </select>
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">搜索选择框</label>
                <div class="layui-input-block">
                    <select name="modules" lay-verify="required" lay-search="">
                        <option value="">直接选择或搜索选择</option>
                        <option value="1">layer</option>
                        <option value="2">form</option>
                        <option value="3">layim</option>
                        <option value="4">element</option>
                        <option value="5">laytpl</option>
                        <option value="6">upload</option>
                        <option value="7">laydate</option>
                        <option value="8">laypage</option>
                        <option value="9">flow</option>
                        <option value="10">util</option>
                        <option value="11">code</option>
                        <option value="12">tree</option>
                        <option value="13">layedit</option>
                        <option value="14">nav</option>
                        <option value="15">tab</option>
                        <option value="16">table</option>
                        <option value="17">select</option>
                        <option value="18">checkbox</option>
                        <option value="19">switch</option>
                        <option value="20">radio</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">部门人员树</label>
                <div class="layui-input-block">
                    <div id="demo" class="layui-form-select select-tree"></div>
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">部门树</label>
                <div class="layui-input-block">
                    <div id="demo1" class="layui-form-select select-tree"></div>
                </div>
            </div>
            <div class="layui-form-item layui-td-1" id="tag_ids">
                <label class="layui-form-label">多选下拉框</label>
                <div class="layui-input-block">
                    <select name="city" xm-select="tag_ids1" xm-select-search="" xm-select-search-type="dl">
                        <option value="">请选择</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label">复选框</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="like[write]" title="写作">
                    <input type="checkbox" name="like[read]" title="阅读" checked="">
                    <input type="checkbox" name="like[game]" title="游戏">
                </div>
            </div>
            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label">原始复选框</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="like1[write]" lay-skin="primary" title="写作" checked="">
                    <input type="checkbox" name="like1[read]" lay-skin="primary" title="阅读">
                    <input type="checkbox" name="like1[game]" lay-skin="primary" title="游戏" disabled="">
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">开关-默认关</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="close" lay-skin="switch" lay-text="ON|OFF">
                </div>
            </div>
            <div class="layui-form-item layui-td-2">
                <label class="layui-form-label">开关-默认开</label>
                <div class="layui-input-block">
                    <input type="checkbox" checked="" name="open" lay-skin="switch" lay-filter="switchTest"
                           lay-text="ON|OFF">
                </div>
            </div>
            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label">单选框</label>
                <div class="layui-input-block">
                    <input type="radio" name="sex" value="男" title="男" checked="">
                    <input type="radio" name="sex" value="女" title="女">
                    <input type="radio" name="sex" value="禁" title="禁用" disabled="">
                </div>
            </div>
            <div class="layui-form-item layui-td-1">
                <label class="layui-form-label">富文本编辑器</label>
                <div class="layui-input-block">
                    <textarea id="hyjd" name="hyjd" style="width:100%;height:180px;"></textarea>
                </div>
            </div>
            <div class="layui-form-item layui-td-1">
                <button type="button" class="layui-btn" id="update_pic">
                    <i class="layui-icon">&#xe67c;</i>上传图片
                </button>
                <ul class="viewer" id='viewer'></ul>
            </div>
            <div class="layui-form-item layui-td-1">
                <button type="button" class="layui-btn" id="update_pic1">
                    <i class="layui-icon">&#xe67c;</i>上传文件
                </button>
                <ul class="viewer" id='viewer1'></ul>
            </div>
            <div class="layui-form-item layui-layout-admin">
                <div class="layui-input-block">
                    <div class="layui-footer" style="left: 0;">
                        <button class="layui-btn" lay-submit="" lay-filter="component-form-demo1">立即提交</button>
                        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        <button type="button" class="layui-btn layui-btn-primary" onclick="openIframe()">弹出</button>
                    </div>
                </div>
            </div>
            <div class="clear"></div>
        </form>
    </div>
    <div id="formNavigation">
        <div id="formNavigationHide" class="form-navigation-hide" onclick="hideNavigation(false);">
            <img src="${ctx.contextPath}/layui/commons/images/xf_icon.png" />
        </div>
        <div id="formNavigationBox" class="form-navigation">
            <p>
                <span>目录</span>
                <i onclick="hideNavigation(true);" class="layui-icon layui-icon-close"></i>
            </p>
            <ul>
                <li><a href="#form1">表单项一</a></li>
                <li>表单项二</li>
                <li>表单项三</li>
                <li>表单项四</li>
                <li>表单项五</li>
            </ul>
        </div>
    </div>
</div>


<script>
    var openType = 1;
    var treeObj;
    var id;
    var name;
    var index = parent.layer.getFrameIndex(window.name);
    KindEditor.ready(function (K) {
        window.editor_hyjd = K.create('#hyjd');
    });
    layui.config({
        base: '${ctx.contextPath}/layui/layui_extends/'
    });
    // 一键只读
    /*$(function(){
        $('input,select,textarea').prop('disabled',"disabled");
    })*/
    var layer;
    layui.config({
        base: '${ctx.contextPath}/layui/layui_extends/'
    });


    layui.use(['form', 'layedit', 'laydate', 'upload', 'formSelects', 'layer', 'verifyE'], function() {
        var form = layui.form
            , layedit = layui.layedit
            , laydate = layui.laydate
            , upload = layui.upload
            , layer = layui.layer
            , formSelects = layui.formSelects
            , verifyE = layui.verifyE;
        //日期
        laydate.render({
            elem: '#date'
        });

        // 自定义验证规则
        verifyE.verify();

        initupload("update_pic", "viewer", true, upload);//初始化图片
        initupload("update_pic1", "viewer1", false, upload, "file");//初始化文件
        $("#bmry").openTree({
            idKey: 'ID',
            pIdKey: 'PID',
            nameKey: 'NAME',
            title: '部门人员树',
            treeUrl: 'dept/userTree'
        });
        $("#bm").openTree({
            idKey: 'ID',
            pIdKey: 'PARENTID',
            nameKey: 'NAME',
            title: '部门树',
            treeUrl: 'common/zTree/list',
            ajax_par: {"tableid": "ss_dept"}
        });
        getTreeData();//初始化下拉树
        getTreeData1();

        layui.formSelects.data('tag_ids1', 'local', {
            arr: [
                {"name": "分组-1", "type": "optgroup"},
                {"name": "北京", "value": 1},
                {"name": "上海", "value": 2},
                {"name": "分组-2", "type": "optgroup"},
                {"name": "广州", "value": 3},
                {"name": "深圳", "value": 4},
                {"name": "天津", "value": 5}
            ]
        });

        var initXmSelect = xmSelect.render({
            el: '#formListSelect',
            filterable: true,
            data: [],
            on:function(ret){
                var changeArr = ret.change;
                for(var index in changeArr){
                    var changeName = changeArr[index].value;
                    var changeInput = $("input[name='"+changeName+"']").parents(".layui-form-item");
                    if(ret.isAdd){
                        changeInput.removeClass("layui-hide");
                        changeInput.addClass("layui-show");
                    }else{
                        changeInput.removeClass("layui-show");
                        changeInput.addClass("layui-hide");
                    }
                }
            },
        })
        initXmSelect.update({
            data: [
                {name: '验证手机', value: "phone",selected: true},
                {name: '验证邮箱', value: "email",selected: true},
                {name: '人员弹出树', value: "bmry",selected: true},
            ]
        })

        commons.bindEnterKey(saveCallBack, true);

        function saveCallBack() {
            layer.alert("提交成功");
        }
    });

    function openIframe() {
        var index = layer.open({
            type: 2,
            title: '123456',
            content: 'http://www.baidu.com',
            btn: ['按钮一', '按钮二', '按钮三'],
            area: ['810px', '80%'],
            fixed: false
        });
        layer.iframeAuto(index);
    }

    //附件保存
    /*var gptpArr = [];
    var gptp = $("#viewer").children();
    for(var i = 0; i < gptp.length; i++ ){
        gptpArr.push($(gptp[i]).attr('id'));
    }*/
    //初始化下拉树
    function getTreeData() {
        var ajax = new Ajax("dept/userTree", function (data) {
            if (judgeRight(data)) {
                var zNodes = data.dataset.rows;
                initSelectTree("demo", true, zNodes, {"Y": "ps", "N": "s"});
            }
        });
        ajax.submit();
    }

    function getTreeData1() {
        var ajax = new Ajax("common/zTree/list", function (data) {
            if (judgeRight(data)) {
                var zNodes = data.dataset.rows;
                initSelectTree("demo1", true, zNodes, {"Y": "ps", "N": "s"}, "ID", "PARENTID");
            }
        });
        ajax.add('tableid', 'ss_dept');
        ajax.submit();
    }

    function hideNavigation(state){
        if(state){
            $("#formNavigationHide").css("display","block");
            $("#formNavigationBox").css("display","none");
        }else{
            $("#formNavigationBox").css("display","block");
            $("#formNavigationHide").css("display","none");
        }
    }

    /* function getTree(){
         treeObj={
             url:'dept/userTree',//数据源接口
             isMultiple:'true',//是否多选
             idKey:"ID",//节点id
             pIdKey:"PID",//父节点id
             nameKey:'NAME'/!*,//name名称
             chkboxType:'{"Y": "ps", "N": "s"}'*!///多选框类型{"Y": "ps", "N": "s"}
         }
         var param = {
             type: 2,
             area: ['500px', '80%'],
             title:'部门人员树',
             fixed: false, //不固定
             content: Apps.ContextPath+"demo/set"
         };
         openPage(openType,'',param);
     }*/

</script>
</body>

</html>