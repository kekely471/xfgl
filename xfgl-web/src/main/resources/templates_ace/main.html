<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta charset="utf-8"/>
    <title>系统首页</title>

    <meta name="description" content="首页"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="ace/assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="ace/assets/font-awesome/4.5.0/css/font-awesome.min.css"/>

    <!-- page specific plugin styles -->
    <link rel="stylesheet" href="ace/assets/css/jquery-ui.custom.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/jquery-ui.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/jquery.gritter.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/chosen.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/bootstrap-datepicker3.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/bootstrap-timepicker.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/daterangepicker.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/bootstrap-datetimepicker.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/bootstrap-colorpicker.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/ui.jqgrid.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/bootstrap-duallistbox.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/zTreeStyle.css">
    <!-- text fonts -->
    <link rel="stylesheet" href="ace/assets/css/fonts.googleapis.com.css"/>

    <!-- ace styles -->
    <link rel="stylesheet" href="ace/assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style"/>

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="ace/assets/css/ace-part2.min.css" class="ace-main-stylesheet"/>
    <![endif]-->
    <link rel="stylesheet" href="ace/assets/css/ace-skins.min.css"/>
    <link rel="stylesheet" href="ace/assets/css/ace-rtl.min.css"/>

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="ace/assets/css/ace-ie.min.css"/>
    <![endif]-->

    <!-- inline styles related to this page -->

    <!-- ace settings handler -->
    <script src="ace/assets/js/ace-extra.min.js"></script>

    <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

    <!--[if lte IE 8]>
    <script src="ace/assets/js/html5shiv.min.js"></script>
    <script src="ace/assets/js/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="ace/css/base.css"/>

</head>

<body class="no-skin">
<div id="navbar" class="navbar navbar-default    navbar-collapse       h-navbar ace-save-state">
    <div class="navbar-container ace-save-state" id="navbar-container">
        <div class="navbar-header pull-left">
            <a href="main" class="navbar-brand">
                <small>
                    <i class="fa fa-lemon-o"></i>
                    ITSM&nbsp;
                </small>
            </a>
        </div>

        <div class="navbar-buttons navbar-header pull-right  collapse navbar-collapse" role="navigation">
            <ul class="nav ace-nav">
                <li class="transparent dropdown-modal">
                    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                        <i class="ace-icon fa fa-bell icon-animated-bell"></i>
                        <span class="badge badge-danger">10</span>
                    </a>

                    <div class="dropdown-menu-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close">
                        <div class="tabbable">
                            <div class="tab-content">
                                <!-- 我的消息TAB -->
                                <div id="navbar-messages" class="tab-pane in active">
                                    <ul class="dropdown-menu-right dropdown-navbar dropdown-menu">
                                        <li class="dropdown-content">
                                            <ul class="dropdown-menu dropdown-navbar">
                                                <li>
                                                    <a href="#">
                                                        <img src="ace/assets/images/avatars/avatar.png" class="msg-photo"
                                                             alt="Alex's Avatar"/>
                                                        <span class="msg-body">
                <span class="msg-title">
                <span class="blue">Alex:</span>
                Ciao sociis natoque penatibus et auctor ...
                </span>

                <span class="msg-time">
                <i class="ace-icon fa fa-clock-o"></i>
                <span>a moment ago</span>
                </span>
                </span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="dropdown-footer">
                                            <a href="#">
                                                更多消息
                                                <i class="ace-icon fa fa-arrow-right"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </div><!-- /.tab-pane -->
                            </div><!-- /.tab-content -->
                        </div><!-- /.tabbable -->
                    </div><!-- /.dropdown-menu -->
                </li>

                <li class="light-blue dropdown-modal user-min">
                    <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                        <img class="nav-user-photo" src="ace/assets/images/avatars/user.jpg" alt="Jason's Photo"/>
                        <span class="user-info">
									<small>欢迎,</small>
									${Session.loginuser.username}
								</span>

                        <i class="ace-icon fa fa-caret-down"></i>
                    </a>

                    <ul class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                        <!--<li>-->
                        <!--<a href="#">-->
                        <!--<i class="ace-icon fa fa-cog"></i>-->
                        <!--个人设置-->
                        <!--</a>-->
                        <!--</li>-->

                        <li>
                            <a href="#" onclick="_editPassword()" ;>
                                <i class="ace-icon fa fa-key"></i>
                                修改密码
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="_clearConfig();">
                                <i class="ace-icon fa fa-user"></i>
                                清空配置缓存
                            </a>
                        </li>
                        <li class="divider"></li>

                        <li>
                            <a href="#" onclick="_loginOut();">
                                <i class="ace-icon fa fa-power-off"></i>
                                退出系统
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>


        <!--一级菜单区域-->
        <nav role="navigation" class="navbar-menu pull-left collapse navbar-collapse">
            <ul id="navlist" class="nav navbar-nav">

                [#list Session.loginuser.menus as list]
                [#if list["PARENTID"]="00"]
                <li id="top_${list["ID"]}">
                <a href="#" class="dropdown-toggle" onclick="showSubMenu('${list["ID"]}');" data-toggle="dropdown">
                <i class="${list["ICON"]}"></i>
                ${list["MENUNAME"]}
                &nbsp;
                <!--<i class="ace-icon fa fa-angle-down bigger-110"></i>-->
                </a>
                <!--下拉菜单-->
                <!--<ul class="dropdown-menu dropdown-light-blue dropdown-caret">-->
                <!--<li>-->
                <!--<a href="#">-->
                <!--<i class="ace-icon fa fa-eye bigger-110 blue"></i>-->
                <!--Monthly Visitors-->
                <!--</a>-->
                <!--</li>-->
                <!--</ul>-->
                </li>
                [/#if]
                [/#list]
            </ul>
            <!--&lt;!&ndash;全局检索&ndash;&gt;-->
            <!--<form class="navbar-form navbar-left form-search" role="search">-->
            <!--<div class="form-group">-->
            <!--<input type="text" style="width: 460px;" placeholder="知识库检索"/>-->
            <!--</div>-->

            <!--<button type="button" class="btn btn-mini btn-info2">-->
            <!--<i class="ace-icon fa fa-search icon-only bigger-110"></i>-->
            <!--</button>-->
            <!--</form>-->
        </nav>
    </div><!-- /.navbar-container -->
</div>


<div class="main-container ace-save-state" id="main-container">
    <script type="text/javascript">
        try {
            ace.settings.loadState('main-container')
        } catch (e) {
        }
    </script>

    <div id="sidebar" class="sidebar h-sidebar navbar-collapse collapse ace-save-state">
        <script type="text/javascript">
            try {
                ace.settings.loadState('sidebar')
            } catch (e) {
            }
        </script>
        <!--二级菜单区域-->
        <ul id="menulist" class="nav nav-list">
            <!--<li class="hover">-->
            <!--<a href="#">-->
            <!--<i class="menu-icon fa fa-tachometer"></i>-->
            <!--<span class="menu-text"> 工作台 </span>-->
            <!--</a>-->

            <!--<b class="arrow"></b>-->
            <!--</li>-->
            [#list Session.loginuser.menus as list]
            [#if list["ID"]?length = 4 ]
            <li class="hover" style="display: none" id="menu_${list["PARENTID"]}_${list["ID"]}">
            <!--<li class="active open hover">-->
            <a href="#" class="dropdown-toggle">
                <i class="menu-icon ${list["ICON"]}"></i>
                <span class="menu-text">${list["MENUNAME"]}</span>
                <b class="arrow fa fa-angle-down"></b>
            </a>
            <b class="arrow"></b>
            <ul class="submenu">
                [#list Session.loginuser.menus as sublist]
                [#if sublist["ID"]?length = 6  ]
                [#if sublist["ID"]?substring(0,4) =list["ID"] ]
                <li class="hover">
                    <a id="submenu_a_${sublist["ID"]}" href="#" onclick="loadContent('${sublist["URL"]}','','${list["PMENUNAME"]}','${sublist["PMENUNAME"]}','${sublist["MENUNAME"]}');" >
                    <i class="menu-icon ${sublist["ICON"]}"></i>
                    ${sublist["MENUNAME"]}
                    </a>
                    <b class="arrow"></b>
                </li>
                [/#if]
                [/#if]
                [/#list]
            </ul>
            </li>
            [/#if]
            [/#list]

        </ul><!-- /.nav-list -->
    </div>
    <!-- 主要内容区域 -->

    <div class="main-content">
        <div class="main-content">
            <div class="main-content-inner">

                <div class="breadcrumbs ace-save-state" id="breadcrumbs">
                    <ul class="breadcrumb">
                        <li>
                            <i class="ace-icon fa fa-home home-icon"></i>
                            <a href="#" onclick="loadHome();" >首页</a>
                        </li>
                        <li>
                            <a href="#" id="topnav" >XXX</a>
                        </li>
                        <li class="active" id="menunav">XXXX管理</li>
                        <li class="active" id="submenunav">XXXX管理</li>
                    </ul><!-- /.breadcrumb -->
                </div>
                <div id="mainContent">

                </div>
            </div>

        </div>

    </div>
    <!-- /.main-content -->
    <!-- 模态框（Modal） -->
    <div id="editPwd-form" class="modal fade" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">

            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div>
    <!-- 版权 -->
    <div class="footer">
        <div class="footer-inner">
            <div class="footer-content">
						<span class="bigger-120">
							<span class="blue bolder">Message</span>
							tonbusoft.com &copy; 2018-2020
						</span>

            </div>
        </div>
    </div>
    <!-- 回到顶部 -->
    <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
        <i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
    </a>
</div><!-- /.main-container -->


<div id="base-form" class="modal fade" tabindex="-1">

    <div class="modal-dialog">
        <div class="modal-content">


        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- basic scripts -->

<!--[if !IE]> -->
<script src="ace/assets/js/jquery-2.1.4.min.js"></script>

<!-- <![endif]-->

<!--[if IE]>
<script src="ace/assets/js/jquery-1.11.3.min.js"></script>
<![endif]-->
<script type="text/javascript">
    if ('ontouchstart' in document.documentElement) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
</script>
<script src="ace/assets/js/bootstrap.min.js"></script>

<!-- page specific plugin scripts -->

<!--[if lte IE 8]>
<script src="ace/assets/js/excanvas.min.js"></script>
<![endif]-->
<script src="ace/assets/js/jquery-ui.custom.min.js"></script>
<script src="ace/assets/js/jquery.ui.touch-punch.min.js"></script>
<script src="ace/assets/js/chosen.jquery.min.js"></script>
<script src="ace/assets/js/spinbox.min.js"></script>
<script src="ace/assets/js/bootstrap-datepicker.min.js"></script>
<script src="ace/assets/js/bootstrap-timepicker.min.js"></script>
<script src="ace/assets/js/moment.min.js"></script>
<script src="ace/assets/js/daterangepicker.min.js"></script>
<script src="ace/assets/js/bootstrap-datetimepicker.min.js"></script>
<script src="ace/assets/js/bootstrap-colorpicker.min.js"></script>
<script src="ace/assets/js/bootstrap-tag.min.js"></script>
<script src="ace/assets/js/jquery.knob.min.js"></script>
<script src="ace/assets/js/autosize.min.js"></script>
<script src="ace/assets/js/jquery.inputlimiter.min.js"></script>
<script src="ace/assets/js/jquery.maskedinput.min.js"></script>
<script src="ace/assets/js/tree.min.js"></script>
<script src="ace/assets/js/jquery.jqGrid.min.js"></script>
<script src="ace/assets/js/grid.locale-en.js"></script>
<script src="ace/assets/js/jquery.validate.min.js"></script>
<script src="ace/assets/js/bootbox.js"></script>
<script src="ace/assets/js/jquery.bootstrap-duallistbox.min.js"></script>
<script src="ace/assets/js/jquery.ztree.core.min.js"></script>
<script src="ace/assets/js/jquery.ztree.excheck.min.js"></script>
<!--富文本编辑器-->
<script src="ace/assets/js/kindeditor/kindeditor.js"></script>
<script src="ace/assets/js/kindeditor/lang/zh_CN.js"></script>
<!-- ace scripts -->
<script src="ace/assets/js/ace-elements.min.js"></script>
<script src="ace/assets/js/ace.min.js"></script>
<!-- 百度地图 -->
<script type="text/javascript"
        src="http://api.map.baidu.com/api?v=2.0&ak=qwGmX8nAT7sjhXCG1iyt4FQ7t5DwC0V7"></script>
<!-- production -->
<script type="text/javascript" src="ace/assets/js/plupload.full.min.js"></script>
<!-- local scripts -->
<script src="ace/js/base.js"></script>
<script src="ace/js/common.js"></script>
<script src="ace/js/ajax.js"></script>
<!-- inline scripts related to this page -->
<script type="text/javascript">
    jQuery(function ($) {
        showSubMenu();
        $(".submenu").each(function(){
            if($(this).text()==""){
                $(this).remove();
            }
        });
        var $sidebar = $('.sidebar').eq(0);
        if (!$sidebar.hasClass('h-sidebar')) return;

        $(document).on('settings.ace.top_menu', function (ev, event_name, fixed) {
            if (event_name !== 'sidebar_fixed') return;

            var sidebar = $sidebar.get(0);
            var $window = $(window);

            //return if sidebar is not fixed or in mobile view mode
            var sidebar_vars = $sidebar.ace_sidebar('vars');
            if (!fixed || (sidebar_vars['mobile_view'] || sidebar_vars['collapsible'])) {
                $sidebar.removeClass('lower-highlight');
                //restore original, default marginTop
                sidebar.style.marginTop = '';

                $window.off('scroll.ace.top_menu');
                return;
            }

            var done = false;
            $window.on('scroll.ace.top_menu', function (e) {
                var scroll = $window.scrollTop();
                scroll = parseInt(scroll / 4);//move the menu up 1px for every 4px of document scrolling
                if (scroll > 17) scroll = 17;
                if (scroll > 16) {
                    if (!done) {
                        $sidebar.addClass('lower-highlight');
                        done = true;
                    }
                }
                else {
                    if (done) {
                        $sidebar.removeClass('lower-highlight');
                        done = false;
                    }
                }
                sidebar.style['marginTop'] = (17 - scroll) + 'px';
            }).triggerHandler('scroll.ace.top_menu');

        }).triggerHandler('settings.ace.top_menu', ['sidebar_fixed', $sidebar.hasClass('sidebar-fixed')]);

        $(window).on('resize.ace.top_menu', function () {
            $(document).triggerHandler('settings.ace.top_menu', ['sidebar_fixed', $sidebar.hasClass('sidebar-fixed')]);
        });

        loadContent(Apps.ContextPath + "home");
    });

    //修改密码
    function _editPassword() {
        $("#editPwd-form").modal({
            backdrop: 'static',
            remote: Apps.ContextPath + "account/editPwd",
        }).on("hidden.bs.modal", function () {
            $(this).removeData("bs.modal");
        });
    }
    //登出系统
    function _loginOut() {
        bootbox.confirm({
            message: "你确认要退出系统吗？",
            buttons: {
                confirm: {
                    label: '是',
                    className: 'btn-success'
                },
                cancel: {
                    label: '否',
                    className: 'btn-danger'
                }
            },
            callback: function (result) {
                if (result) {
                    window.location.href = Apps.ContextPath + "logout";
                }
            }
        });
    }

    function showSubMenu(pid) {
        //如果pid不存在，说明是首次加载，则默认点击第一个
        if(pid==undefined){
            $("#navlist li").each(function(index){
                if(index==0) {
                    $(this).find("a").click();
                }
            });
        }else {
            $("#menulist li").each(function () {
                if ($(this)[0].id != undefined&&$(this)[0].id !="") {
                    if ($(this)[0].id.indexOf("_" + pid + "_") != -1) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                }
            });
        }
    }


    function loadHome() {
        loadContent(Apps.ContextPath + "home");
    }
</script>
</body>
</html>
